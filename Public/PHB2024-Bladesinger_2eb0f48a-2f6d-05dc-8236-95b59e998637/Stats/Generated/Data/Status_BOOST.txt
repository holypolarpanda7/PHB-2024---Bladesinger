new entry "BLADESONG_IMPEDED"
type "StatusData"
using "BLADESONG_IMPEDED"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_WEAPON"
type "StatusData"
using "BLADESONG_WEAPON"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_SHIELD"
type "StatusData"
using "BLADESONG_SHIELD"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_ARMOR"
type "StatusData"
using "BLADESONG_ARMOR"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_UNARMED"
type "StatusData"
using "BLADESONG_UNARMED"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_WEAPON_MESSAGE"
type "StatusData"
using "BLADESONG_WEAPON_MESSAGE"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_SHIELD_MESSAGE"
type "StatusData"
using "BLADESONG_SHIELD_MESSAGE"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_ARMOR_MESSAGE"
type "StatusData"
using "BLADESONG_ARMOR_MESSAGE"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG_UNARMED_MESSAGE"
type "StatusData"
using "BLADESONG_UNARMED_MESSAGE"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
data "Icon" ""
data "DisplayName" ""
data "Description" ""
data "StatusType" "INVISIBLE"

new entry "BLADESONG"
type "StatusData"
using "BLADESONG"
data "OnApplyFunctors" "ApplyEquipmentStatus(MeleeMainHand,BLADEWORK_CUSTOM,100,10);ApplyEquipmentStatus(MeleeOffHand,BLADEWORK_CUSTOM,100,10);ApplyEquipmentStatus(RangedMainHand,BLADEWORK_CUSTOM,100,10);ApplyStatus(SELF,BLADESONG_WEAPON_WATCHER,100,-1)"
data "OnRemoveFunctors" "RemoveStatus(SELF,BLADESONG_WEAPON_WATCHER);ApplyEquipmentStatus(MeleeMainHand,BLADEWORK_REMOVE_CUSTOM,100,1);ApplyEquipmentStatus(MeleeOffHand,BLADEWORK_REMOVE_CUSTOM,100,1);ApplyEquipmentStatus(RangedMainHand,BLADEWORK_REMOVE_CUSTOM,100,1);ApplyEquipmentStatus(RangedOffHand,BLADEWORK_REMOVE_CUSTOM,100,1)"

new entry "BLADESONG_WEAPON_WATCHER"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BLADESONG_WEAPON_WATCHER"
data "RemoveConditions" "(WieldingWeapon('Twohanded') and WieldingWeapon('Melee') and not WieldingWeapon('Versatile')) or not HasStatus('BLADESONG')"
data "RemoveEvents" "OnTurn;OnEquip"
data "OnRemoveFunctors" "IF(HasStatus('BLADESONG')):RemoveStatus(BLADESONG)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;IgnoreResting;ApplyToDead"

new entry "BLADEWORK_CUSTOM"
type "StatusData"
data "StatusType" "BOOST"
data "Icon" "Action_Bladesong"
data "StackId" "BLADEWORK_CUSTOM"
data "StackType" "Overwrite"
data "Boosts" "WeaponProperty(Magical);WeaponAttackRollAbilityOverride(Intelligence);IF(IsMeleeWeaponAttack()):DamageBonus(IntelligenceModifier-max(StrengthModifier,DexterityModifier))"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

new entry "BLADEWORK_REMOVE_CUSTOM"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BLADEWORK_CUSTOM"
data "StackPriority" "9"
data "StatusEffect" ""
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"

// Technical status that consumes lowest available spell slot (levels 1-3)
// Uses reverse priority: check highest first with "not has higher" conditions
new entry "BLADESONG_CLIMAX_SLOT_CONSUME"
type "StatusData"
data "StatusType" "BOOST"
data "StackId" "BLADESONG_CLIMAX_SLOT_CONSUME"
data "OnApplyFunctors" "IF(HasActionResource('SpellSlot',1,1,false,false,context.Target)):UseActionResource(TARGET,SpellSlot,1,1);IF(not HasActionResource('SpellSlot',1,1,false,false,context.Target) and HasActionResource('SpellSlot',1,2,false,false,context.Target)):UseActionResource(TARGET,SpellSlot,1,2);IF(not HasActionResource('SpellSlot',1,1,false,false,context.Target) and not HasActionResource('SpellSlot',1,2,false,false,context.Target) and HasActionResource('SpellSlot',1,3,false,false,context.Target)):UseActionResource(TARGET,SpellSlot,1,3);RemoveStatus(SELF,BLADESONG_CLIMAX_SLOT_CONSUME)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator;ApplyToDead;IgnoreResting"
